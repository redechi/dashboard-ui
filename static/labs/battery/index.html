<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Battery Health | Automatic Labs</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

      <meta property="og:title" content="Battery Health | Automatic"/>
      <meta property="og:image" content="https://dashboard.automatic.com/assets/img/labs/battery.png"/>
      <meta property="og:site_name" content="Automatic"/>
      <meta property="og:description" content="Analysis of my vehicle's battery health."/>

      <meta name="twitter:card" content="summary_large_image">
      <meta name="twitter:site" content="@automatic">
      <meta name="twitter:title" content="Battery Health | Automatic">
      <meta name="twitter:description" content="Analysis of my vehicle's battery health.">
      <meta name="twitter:image" content="https://dashboard.automatic.com/assets/img/labs/battery.png">

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" />
    <link href="../common/css/style.css" rel="stylesheet" />
    <link href="css/battery.css" rel="stylesheet" />

  </head>
  <body>
    <a class="btn-logout" href="/#/logout">Log out</a>
    <div class="loading">
      <div class="title">Loading...</div>
      <div class="progress"></div>
    </div>
    <div class="wrapper">
      <div>
        <h1 class="labs-title">Battery Health</h1>
        <div class="labs-tagline">By Automatic Labs</div>
      </div>
      <div class="alert alert-warning alert-demo">This is sample data from a demo account. <a class="login-link" href="#">Log in</a> to view your Automatic driving history.</div>

      <h2 class="battery-title">Can your car battery hold a charge?</h2>

      <p>Your car’s battery slowly discharges while it’s parked, and it gets charged when you drive.</p>
      <p>However, it can lose its ability to hold a charge over time. If your “state of charge” is in the Danger Zone, there is a higher risk of your battery dying the next time it’s sitting parked.</p>

      <div class="battery-box">
        <div class="battery-box-title">Your battery's recent performance</div>
        <div class="battery-box-content">
          <div class="controls">
            Vehicle:
            <select id="vehicleChoice"></select>
          </div>

          <div class="battery-graph-container">
            <div id="newBatteryLineGraph"></div>
            <div class="graph-swap-container">
              This graph assumes your battery is <span id="currentGraphType">AGM</span>.
              <a id="swapData" href="#">Switch to <span id="otherGraphType">Lead-Acid</span>.</a>
            </div>
          </div>
        </div>
      </div>

      <h3 class="battery-title">How your battery compares to others</h3>
      <div class="battery-insight">
        After 8 hours of parking, your car battery's state of charge is <span id="relativeStats"></span>.
      </div>


      <h3 class="battery-title">How long before your battery is in the Danger Zone</h2>
      <div class="battery-insight">
        It should take <span id="batteryLife"></span> of your car sitting parked before your car's battery will enter the Danger Zone.
      </div>

      <!-- <div class="share-container hidden" id="shareContainer">
        <div id="shareTitle" class="share-title hidden">Share your Report</div>
        <input id="shareUrl" class="share-url" readonly>
        <a id="share" class="btn btn-lg btn-blue"><i class="fa fa-share"></i> Share your report</a>
        <div class="share-buttons hidden">
          <p>Anyone with this link can see this report.</p>
          <a href="" class="btn btn-blue btn-email" target="_blank"><i class="fa fa-envelope-o"></i> Email</a>
          <a href="" class="btn btn-blue btn-twitter" target="_blank"><i class="fa fa-twitter"></i> Twitter</a>
          <a href="" class="btn btn-blue btn-facebook" target="_blank"><i class="fa fa-facebook"></i> Facebook</a>
        </div>
      </div> -->

      <div class="center-block">
        <p>To help us bring you more insights like these, please take this quick survey.</p>
        <button class="btn btn-lg btn-green" id="surveyButton">Take Battery Survey</button>
      </div>

      <div id="surveyContainer" class="hidden">
        <div class="typeform-widget" data-url="https://inga2.typeform.com/to/eT8kBI" data-text="Battery Health Survey" style="width:100%;height:500px;"></div>
      </div>


      <h2 class="battery-title">Methodology</h2>

      <div class="question">
        <i class="fa fa-chevron-down open-control"></i>
        <h3>How do you calculate the State of Charge graph?</h3>
        <p class="answer">Automatic measures your car battery’s voltage and temperature while your car is parked and combines those factors to produce the State of Charge graph. These measurements are shown with the bold black lines. The dotted lines represent the change in voltage during the time you drive. Currently, Automatic doesn’t show the exact voltage measurements while the car’s ignition is on, but it’s coming soon.</p>
      </div>

      <div class="question">
        <i class="fa fa-chevron-down open-control"></i>
        <h3>Does this tell me if my battery is healthy?</h3>
        <p class="answer">Automatic can’t completely answer that question yet. There are a couple big factors that tell you if your battery is healthy. For example, a healthy battery can both start a car and hold its charge when the car is parked.</p>

        <p class="answer">Factor 1: Can my car’s battery hold a charge?<br />
          This is what Automatic shows you today. If your battery’s State of Charge drops rapidly after the car is parked, you’ll see some of your data points in the area marked DANGER ZONE, which is roughly set at 25% State of Charge.</p>

        <p class="answer">Factor 2: Can my battery deliver the necessary amperage to start the engine? <br />
          While it is important to monitor the battery’s State of Charge while the car is off, it’s just as important to evaluate it right at the moment the car is cranking. Watch out: a fully charged battery may not be able to start a car.</p>

        <p class="answer"><i>Automatic does not currently measure your battery’s state during cranking, but this feature will be implemented soon!  See below for more information about what’s coming next.</i></p>
      </div>

      <div class="question">
        <i class="fa fa-chevron-down open-control"></i>
        <h3>Can my car’s battery hold a charge?</h3>
        <p class="answer">This is what Automatic shows you today. If your battery’s State of Charge drops rapidly after the car is parked, you’ll see some of your data points in the area marked DANGER ZONE, which is roughly set at 25% State of Charge.</p>
      </div>

      <div class="question">
        <i class="fa fa-chevron-down open-control"></i>
        <h3>Can my battery deliver the necessary amperage to start the engine?</h3>
        <p class="answer">While it is important to monitor the battery’s State of Charge while the car is off, it’s just as important to evaluate it right at the moment the car is cranking. Watch out: a fully charged battery may not be able to start a car.</p>

        <p class="answer">Automatic does not currently measure your battery’s state during cranking, but this feature will be implemented soon! See below for more information about what’s coming next.</p>
      </div>

      <div class="question">
        <i class="fa fa-chevron-down open-control"></i>
        <h3>I’m in the danger zone, what does that mean?</h3>
        <p class="answer">At some point in the last week, your car’s battery reached below a 25% State of Charge. This doesn’t mean your car won’t start! However, it could mean one of these things:</p>

        <p class="answer">Your battery needs to be charged. You may have left your lights on or a door open so that your battery’s State of Charge dropped to the danger zone.</p>
        <p class="answer">Your car’s battery has trouble holding a charge. It can still start your car, but if you leave your car parked for a long period of time, you may experience long cranks or trouble starting your car.</p>
      </div>

      <div class="question">
        <i class="fa fa-chevron-down open-control"></i>
        <h3>How does this compare to a battery tester that my mechanic hooks up to my car?</h3>
        <p class="answer">Most battery analyzers will show you your car’s voltage and make an estimate of the State of Charge, just like Automatic does. These analyzers will also give you an estimated CCA value (in some cases an estimated Internal Resistance value). This value will tell you the amount of amperage your battery can deliver compared to it’s rated CCA (see explanation of CCA below).</p>

        <p class="answer">Automatic is doing what these battery analyzers are doing, except that it is taking measurements over 1000 times a day. You’ll be able to see a full history of your battery’s data - seeing all the fluctuations and discharge of your battery while your car is parked. In the future, Automatic will also measure your car’s voltage during cranking to give a more complete picture of your battery’s health.</p>

        <p class="answer">Another neat thing is Automatic measures your car’s battery multiple hours after it has been parked, which means it’s getting a reading without a surface charge on the battery. With many battery testers, you have to wait 30+ min to hook up to the battery to get an accurate reading after the surface charge has dissipated</p>
      </div>

      <div class="question">
        <i class="fa fa-chevron-down open-control"></i>
        <h3>What are Cold Cranking Amps?</h3>
        <p>To start / crank a car, the battery needs to deliver a certain number of amps over a short period. Cold Cranking amps are the number of amperes that a battery can deliver at below freezing temperatures (0 degrees Fahrenheit) for 30 seconds.</p>

        <p>When you buy a battery, aside from the dimensions of the battery, one of the primary metrics used to determine which battery to purchase is the number of Cold Cranking Amps (CCA). While you may not face these conditions when starting your car, it is just a standard of measurement in the industry to compare different batteries and their ability to start your car.</p>
      </div>

      <div class="question">
        <i class="fa fa-chevron-down open-control"></i>
        <h3>Lead Acid or AGM?</h3>
        <p class="answer">The most common type of automotive battery is lead-acid. However, many German vehicles use AGM (Absorbent Glass Mat), which is a specific type of lead acid battery. We’ve chosen your battery type based on what we expect the manufacturer to have installed in your vehicle. If you have changed your battery since you’ve purchased your vehicle, you may have a different type.</p>

        <p class="answer">Based on your type of battery, Automatic re-calculates the State of Charge, so check your owner’s manual or battery itself to make sure you’re seeing the right information.</p>
      </div>

      <div class="question">
        <i class="fa fa-chevron-down open-control"></i>
        <h3>What's next?</h3>
        <p class="answer">Earlier, we mentioned that Automatic can’t completely tell you whether or not your battery is healthy because Automatic is missing one piece of the equation: Can my battery deliver the necessary amperage to start the engine?</p>
        <p class="answer">A battery that appears fully charged may still not be able to start a car due to number of reasons:</p>
        <ul class="answer">
          <li>increased internal resistance (from general wear and tear of a battery from overcharging: oxidation, undercharging: sulfation)</li>
          <li>incorrect battery purchased for a vehicle</li>
          <li>external resistance (e.g., battery terminals are not tight, excessive terminal corrosion)</li>
        </ul>

        <p class="answer">In the coming months, Automatic will be measuring your battery’s voltage during cranking (your car starting) in detail. This will allow us to diagnose further problems with your car’s battery to see if it can do it’s primary job: start your car.</p>
      </div>
    </div>

    <a href="/#/labs" class="automatic-labs" title="Back to Automatic Labs Home">Labs</a>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.14/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.11.1/moment.js"></script>

    <script src="../common/js/main.js"></script>

    <script src="./js/batteryGraph.js"></script>

    <!-- script to configure typeform embed -->
    <script>var typescript = function(){var qs,js,q,s,d=document,gi=d.getElementById,ce=d.createElement,gt=d.getElementsByTagName,id='typef_orm',b='https://s3-eu-west-1.amazonaws.com/share.typeform.com/';if(!gi.call(d,id)){js=ce.call(d,'script');js.id=id;js.src=b+'widget.js';q=gt.call(d,'script')[0];q.parentNode.insertBefore(js,q)}}</script>

    <script>
      var data;
      var accessToken = getAccessToken();

      $('#share').click(function(e) {
        e.preventDefault();

        $('#share').html(generateSpinner());
        saveShareData(data, function(e, shareUrlSlug) {
          if (e) {
            return alert(e);
          }

          var shareURL = window.location.origin + window.location.pathname + '?share=' + shareUrlSlug;
          showShareOptions(shareURL);
        });
      });

      $('#shareUrl').focus(function() {
        $(this).select();
      });

      function showShareOptions(shareURL) {
        $('#shareUrl')
          .val(shareURL)
          .animate({width: 'toggle'}, 350)
          .select();
        $('#share').animate({width: 'toggle'}, 350);
        $('#shareTitle').slideDown();
        $('.share-buttons').slideDown();

        var emailShareURL = formatEmailShare('My Vehicle\'s Battery Voltage', 'A heatmap of my driving.', shareURL);
        var twitterShareURL = formatTwitterShare('A heatmap of my driving.', shareURL);
        var facebookShareURL = formatFacebookShare(shareURL);

        $('.btn-email').attr('href', emailShareURL);
        $('.btn-twitter').attr('href', twitterShareURL);
        $('.btn-facebook').attr('href', facebookShareURL);

        sessionStorage.setItem('batteryShareURL', shareURL);
      }

      $('#surveyButton').click(function() {
        $('#surveyButton').addClass('hidden');
        $('#surveyContainer').removeClass('hidden');
      });

      $('.question').on('click', '.open-control, h3', function() {
        var questionDiv = $(this).parents('.question');
        questionDiv.toggleClass('open');
        $('.answer', questionDiv).slideToggle();
        $('.open-control', questionDiv).toggleClass('fa-chevron-down');
        $('.open-control', questionDiv).toggleClass('fa-chevron-up');
      });

      function calculateBatteryLife(batteryLife) {
        if(batteryLife < 5) {
          return 'less than a week';
        } else if(batteryLife < 9) {
          return 'about a week';
        } else if(batteryLife < 21) {
          return '1-3 weeks';
        } else {
          return 'more than 3 weeks';
        }
      }

      $('#vehicleChoice').change(getUserData);


      function renderData() {
        drawBatteryGraph(data);

        $('#batteryLife').text(calculateBatteryLife(data.battery_life));
        $('#relativeStats').text(data.relative_stats[0][2]);
      }


      function getUserData() {
        // TODO: add moxie endpoint to fetch real data by vehicle ID
        $.ajax({
          url: './js/demo.json',
          data: {
            vehicleId: $('#vehicleChoice').val()
          },
          headers: {
            Authorization: 'bearer ' + accessToken
          }
        })
        .done(function(result) {
          data = result;

          renderData();
        })
        .fail(function(jqXHR, textStatus, errorThrown) {
          console.error(errorThrown);
          alert('Unable to fetch data');
        });
      }

      /* On Page Load */
      formatForDemo();
      showLoginLink('battery');

      // Generate custom typeform url
      typescript(); // execute this script. might want it later, in a handler

      var typeformDataUrl = 'https://inga2.typeform.com/to/eT8kBI';

      fetchVehicles(function(results) {
        if (results.length === 0) {
          // error occurred or user has no vehicles
        } else {
          _.sortBy(results, 'make').forEach(function(vehicle) {
            var vehicleName = vehicle.year + ' ' + vehicle.make + ' ' + vehicle.model;
            $('#vehicleChoice').append('<option value="' + vehicle.id + '">' + vehicleName  + '</option>');
          })
        }
      });

      var queryParams = getQueryParams(document.location.search);
      if (queryParams.share) {
        getShareData(queryParams.share, function(e, result) {
          if (e) {
            return alert(e);
          }

          data = result;
          renderData();
        });
      } else {
        getUserData();
        if (!queryParams.demo) {
          $('#shareContainer').show();

          if (sessionStorage.getItem('batteryShareURL')) {
            showShareOptions(sessionStorage.getItem('batteryShareURL'));
          }
        }
      }
    </script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-33317148-1', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>
